<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Parth's Blog</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Parth's Blog Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Parth's Blog </a></h1>
                <nav><ul>
                    <li><a href="/pages/about-me.html">About Me</a></li>
                    <li><a href="/category/misc.html">misc</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/scraping-laliga-statistics-201819.html">Scraping LaLiga Statistics 2018/19</a></h1>
<footer class="post-info">
        <abbr class="published" title="2019-08-19T00:00:00-04:00">
                Published: Mon 19 August 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info --><h2>Environment Setup</h2>
<p>I have used Python 3.6 for this tutorial. The required libraries are as follows:</p>
<ul>
<li>numpy</li>
<li>pandas</li>
<li>bs4 (BeautifulSoup)</li>
<li>urllib (Module for working with URLs)</li>
</ul>
<h2>Web Scraping from msn.com</h2>
<p><img alt="image" src="images/laliga-home.png"></p>
<p>The website lists the scores for each month on a separate page and it follows this pattern: </p>
<p><em>https://www.msn.com/en-us/sports/soccer/la-liga/scores/</em></p>
<p><em>https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428</em></p>
<p><em>https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428-d-20190331</em></p>
<p><em>https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428-d-20190331-d-20190303</em></p>
<p>As we can see notice the pattern here:(<em>I</em>)</p>
<p>http://............./sp-d-(<em>new-match-date</em>)-d-(<em>past-date</em>)-d-(<em>past-date</em>).</p>
<p>I recorded those dates in a list and created a function that gives me all the links.</p>
<div class="highlight"><pre><span></span><span class="n">links</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;20190428&#39;</span><span class="p">,</span> <span class="s1">&#39;20190331&#39;</span><span class="p">,</span> <span class="s1">&#39;20190303&#39;</span><span class="p">,</span> <span class="s1">&#39;20190203&#39;</span><span class="p">,</span> <span class="s1">&#39;20190106&#39;</span><span class="p">,</span> <span class="s1">&#39;20181209&#39;</span><span class="p">,</span> <span class="s1">&#39;20181111&#39;</span><span class="p">,</span> <span class="s1">&#39;20181014&#39;</span><span class="p">,</span> <span class="s1">&#39;20180916&#39;</span><span class="p">,</span> <span class="s1">&#39;20180819&#39;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">fetch_website</span><span class="p">(</span><span class="n">links</span><span class="p">):</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.msn.com/en-us/sports/soccer/la-liga/scores/&#39;</span>
    <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">+=</span> <span class="s1">&#39;sp&#39;</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span>  <span class="nb">enumerate</span><span class="p">(</span><span class="n">links</span><span class="p">):</span>
        <span class="n">url</span> <span class="o">+=</span> <span class="s1">&#39;-d-&#39;</span> <span class="o">+</span> <span class="n">links</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">urls</span>

<span class="n">urls</span> <span class="o">=</span> <span class="n">fetch_website</span><span class="p">(</span><span class="n">links</span><span class="p">)</span>
</pre></div>


<p><code>['https://www.msn.com/en-us/sports/soccer/la-liga/scores/',
 'https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428',
 'https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428-d-20190331',
 'https://www.msn.com/en-us/sports/soccer/la-liga/scores/sp-d-20190428-d-20190331-d-20190303'...]</code></p>
<p>Once we have the links, all we have to do is create a script that runs through all the links and gives us the desired output. The page source of the web page looks like this:</p>
<p><img alt="image" src="images/laliga-pagesource.jpg"></p>
<p>Our scores are listed in the <em>sectionsgroup</em> container. Each team scores are in a <em>tbody</em> tag distributed by <em>even rowlink</em> and <em>odd rownlink</em> classes. Now we can use the power of BeautifulSoup to scrape the contents with just two functions:</p>
<ul>
<li><em>find</em>: This function takes the name of the tag as string input and returns the first found match from the webpage. <ul>
<li>Here we will find the <em>div</em> container with class <em>sectionsgroup</em> that contains all the score results.</li>
</ul>
</li>
<li><em>findAll</em>: to extract all the occurrences of a particular tag from the page.<ul>
<li>Here we will <em>findAll</em> the <em>tbody</em> tags with classes <em>even rowlink</em> &amp; <em>odd rowlink</em> and then loop through each of them to get the contents.</li>
</ul>
</li>
</ul>
<p>The following is the code to scrape just one webpage:</p>
<div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://www.msn.com/en-us/sports/soccer/la-liga/scores/&#39;</span>
<span class="n">html</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;sectionsgroup&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;even rowlink&#39;</span><span class="p">,</span> <span class="s1">&#39;odd rowlink&#39;</span><span class="p">]})</span>
<span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
    <span class="n">home_team</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamname teaminline alignright size23&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">away_team</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamname size23&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">match_date</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;groupingcolumn paddingleft&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;matchdate&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamscore&#39;</span><span class="p">})</span>

    <span class="n">home_team_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">away_team_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

    <span class="n">data_link</span> <span class="o">=</span> <span class="s1">&#39;https://www.msn.com&#39;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>
</pre></div>


<p>This gives us the team names, match date, their scores and the <em>data_link</em>(link that takes us to a separate page for detailed statistics of each match) using just <em>find</em> and <em>findAll</em> tags. Now to run through all pages we just have to run this for each and every link and append the results to a list.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_html</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">teams</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">raw</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;sectionsgroup&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;tbody&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;even rowlink&#39;</span><span class="p">,</span> <span class="s1">&#39;odd rowlink&#39;</span><span class="p">]})</span>
        <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
            <span class="n">home_team</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamname teaminline alignright size23&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">away_team</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamname size23&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">match_date</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;groupingcolumn paddingleft&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;matchdate&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamscore&#39;</span><span class="p">})</span>

            <span class="n">home_team_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">away_team_score</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

            <span class="n">data_link</span> <span class="o">=</span> <span class="s1">&#39;https://www.msn.com&#39;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>

            <span class="n">teams</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">match_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">match_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">home_team</span><span class="p">,</span> <span class="n">away_team</span><span class="p">,</span>
                          <span class="n">home_team_score</span><span class="p">,</span> <span class="n">away_team_score</span><span class="p">,</span> <span class="n">data_link</span><span class="p">])</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">teams</span>
</pre></div>


<p><code>[['Sun',
  'May 19',
  'Eibar',
  'Barça',
  '2',
  '2',
  'https://www.msn.com/en-us/sports/soccer/la-liga/eibar-v-barcelona/game-center/sp-id-80402000001009693'],
 ['Sun',
  'May 19',
  'Real Madrid',
  'Betis',
  '0',
  '2',
  'https://www.msn.com/en-us/sports/soccer/la-liga/real-madrid-v-real-betis/game-center/sp-id-80402000001009694'],
  ...
 ]</code></p>
<p>Now I don't only want the scores, I want the detailed statistics for each and every match such as team's posession, offsides, fouls, etc. This can be obtained by following the same scraping process we did above, but now for each <em>data_link</em> that we obtain from each match.</p>
<p><img alt="image" src="images/laliga-stats.jpg">
<strong>Note</strong>: This image is from the 2019/20 season as msn have updated it to the current season.</p>
<p>The following is the page source for one of the matches:</p>
<p><img alt="image" src="images/laliga-statsdetail.jpg"></p>
<p>The information of detailed stats is in the <em>div</em> container with id <em>matchupgamestatsmodule</em>. And all the individual statistics is present in the <em>div</em> container with class <em>statsitem</em>.</p>
<div class="highlight"><pre><span></span><span class="n">html_link</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">data_link</span><span class="p">)</span>
<span class="n">raw_link</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_link</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
<span class="n">result_link</span> <span class="o">=</span> <span class="n">raw_link</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;main&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;matchupgamestatsmodule&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;statsitem&#39;</span><span class="p">})</span>
</pre></div>


<div class="highlight"><pre><span></span>[<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;statsitem&quot;</span><span class="p">&gt;</span> 
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;statsvalue clearfix&quot;</span><span class="p">&gt;</span> 
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;firstteamstats&quot;</span><span class="p">&gt;</span>28<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;label&quot;</span><span class="p">&gt;</span> BALL POSSESSION % <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;secondteamstats&quot;</span><span class="p">&gt;</span>72<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
 ...
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;firstteamstats&quot;</span><span class="p">&gt;</span>11<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
 <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;label&quot;</span><span class="p">&gt;</span> SHOTS <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;secondteamstats&quot;</span><span class="p">&gt;</span>11<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
 ...]
</pre></div>


<p>Here there is no way to separate out individual statistics as all the class labels have been named the same for each statistics. The only way to separate them out is the text of the <em>div</em> tag with class <em>label</em>. So instead of fetching each stats through html elements, I simply converted them into a list which is simply looping through each <em>statsitem</em> container and get the textual data.</p>
<div class="highlight"><pre><span></span><span class="n">stats</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">rl</span> <span class="ow">in</span> <span class="n">result_link</span><span class="p">:</span>
  <span class="n">stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rl</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
</pre></div>


<p>Now we have a nice list with individual statistics. The first and the last value in the list represent the stats of home team and away team respectively. </p>
<p>[['28', 'BALL', 'POSSESSION', '%', '72'], 
['11', 'SHOTS', '11'], 
['5', 'SHOTS', 'ON', 'GOAL', '2'], 
['14', 'FOULS', '9'], 
['3', 'CORNERS', '8'], 
['2', 'SAVES', '4'], 
['2', 'OFFSIDES', '1'], 
['1', 'YELLOW', 'CARDS', '1'], 
['0', 'RED', 'CARDS', '0']]</p>
<p>The second element in each list would be an identifier for each type of stats. I created a separate function <em>get_stats(stats)</em> for that. The <em>stats</em> parameter in the function is the list we obtained above which can be passed through our main <em>get_html()</em> function.</p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_stats</span><span class="p">(</span><span class="n">stats</span><span class="p">):</span>
    <span class="n">stat_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BALL&#39;</span><span class="p">,</span> <span class="s1">&#39;SHOTS&#39;</span><span class="p">,</span> <span class="s1">&#39;FOULS&#39;</span><span class="p">,</span> <span class="s1">&#39;CORNERS&#39;</span><span class="p">,</span> <span class="s1">&#39;SAVES&#39;</span><span class="p">,</span> <span class="s1">&#39;OFFSIDES&#39;</span><span class="p">,</span> <span class="s1">&#39;YELLOW&#39;</span><span class="p">,</span> <span class="s1">&#39;RED&#39;</span><span class="p">]</span>
    <span class="n">len_stats</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
    <span class="n">home_shots_og</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_shots_og</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_saves</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_saves</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_offsides</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_offsides</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_poss</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_poss</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_fouls</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_fouls</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_shots</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_shots</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_corners</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_corners</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_yellow</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_yellow</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">home_red</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">away_red</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">len_stats</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">stat_list</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;BALL&#39;</span><span class="p">:</span>
                <span class="n">home_poss</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_poss</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FOULS&#39;</span><span class="p">:</span>
                <span class="n">home_fouls</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_fouls</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;CORNERS&#39;</span><span class="p">:</span>
                <span class="n">home_corners</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_corners</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SAVES&#39;</span><span class="p">:</span>
                <span class="n">home_saves</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_saves</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;OFFSIDES&#39;</span><span class="p">:</span>
                <span class="n">home_offsides</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_offsides</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;YELLOW&#39;</span><span class="p">:</span>
                <span class="n">home_yellow</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_yellow</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RED&#39;</span><span class="p">:</span>
                <span class="n">home_red</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">away_red</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SHOTS&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="n">home_shots</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">away_shots</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">home_shots_og</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">away_shots_og</span> <span class="o">=</span> <span class="n">stats</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span><span class="p">(</span><span class="n">home_poss</span><span class="p">,</span> <span class="n">away_poss</span><span class="p">,</span> <span class="n">home_shots</span><span class="p">,</span> <span class="n">away_shots</span><span class="p">,</span> <span class="n">home_shots_og</span><span class="p">,</span> <span class="n">away_shots_og</span><span class="p">,</span> <span class="n">home_fouls</span><span class="p">,</span> <span class="n">away_fouls</span><span class="p">,</span> <span class="n">home_corners</span><span class="p">,</span> 
           <span class="n">away_corners</span><span class="p">,</span> <span class="n">home_saves</span><span class="p">,</span> <span class="n">away_saves</span><span class="p">,</span> <span class="n">home_offsides</span><span class="p">,</span> <span class="n">away_offsides</span><span class="p">,</span> <span class="n">home_yellow</span><span class="p">,</span> <span class="n">away_yellow</span><span class="p">,</span> <span class="n">home_red</span><span class="p">,</span> <span class="n">away_red</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_html</span><span class="p">(</span><span class="n">urls</span><span class="p">):</span>
    <span class="n">teams</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="p">:</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">raw</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
        <span class="o">........</span>
        <span class="n">data_link</span> <span class="o">=</span> <span class="s1">&#39;https://www.msn.com&#39;</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">html_link</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">data_link</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">urllib</span><span class="o">.</span><span class="n">error</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">:</span>
                <span class="c1"># check this at the end. hard coded link</span>
                <span class="n">html_link</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s1">&#39;https://www.msn.com/en-us/sports/soccer/la-liga/eibar-v-barcelona/game-center/sp-id-80402000001009693&#39;</span><span class="p">)</span>
            <span class="n">raw_link</span> <span class="o">=</span> <span class="n">bs4</span><span class="o">.</span><span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">html_link</span><span class="p">,</span> <span class="s1">&#39;lxml&#39;</span><span class="p">)</span>
            <span class="n">result_link</span> <span class="o">=</span> <span class="n">raw_link</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;main&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;matchupgamestatsmodule&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;statsitem&#39;</span><span class="p">})</span>

            <span class="n">stats</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">rl</span> <span class="ow">in</span> <span class="n">result_link</span><span class="p">:</span>
                <span class="n">stats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rl</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">stats</span><span class="p">)</span>
            <span class="n">teams</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">match_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">match_date</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">:],</span> <span class="n">home_team</span><span class="p">,</span> <span class="n">away_team</span><span class="p">,</span>
                          <span class="n">home_team_score</span><span class="p">,</span> <span class="n">away_team_score</span><span class="p">,</span> <span class="n">data_link</span><span class="p">,</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                          <span class="n">res</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">9</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">10</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span>
                          <span class="n">res</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">17</span><span class="p">]])</span>

        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">teams</span>
</pre></div>


<p>This gives us all the match results with individual team statistics. We can also derive some statistics of our own from this. For example, I was curious to know if some teams are more likely to score in the first half or second half. So I created a separate function <em>get_score_count_perhalf(score_link)</em> to find number of goals scored by both home and away teams in each of the halves. </p>
<div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_score_count_perhalf</span><span class="p">(</span><span class="n">score_link</span><span class="p">):</span>
    <span class="n">result_link</span> <span class="o">=</span> <span class="n">score_link</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;main&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;teamevent&#39;</span><span class="p">})</span>
    <span class="n">home_team_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">home_team_scores_firsthalf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">home_team_scores_secondhalf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">home_team_link</span> <span class="o">=</span> <span class="n">result_link</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;hometeamevent&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;scoremins&#39;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">home_team_link</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">45</span><span class="p">:</span>
                <span class="n">home_team_scores_firsthalf</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">45</span><span class="p">:</span>
                <span class="n">home_team_scores_secondhalf</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">home_team_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># check this later.(Leganes vs Celta: Apr 27)</span>
        <span class="n">home_team_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
        <span class="n">home_team_scores_firsthalf</span> <span class="o">=</span> <span class="mi">99</span>
        <span class="n">home_team_scores_secondhalf</span> <span class="o">=</span> <span class="mi">99</span>

    <span class="n">away_team_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">away_team_scores_firsthalf</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">away_team_scores_secondhalf</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">away_team_link</span> <span class="o">=</span> <span class="n">result_link</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;div&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;visitingteamevent&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;scoremins&#39;</span><span class="p">})</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">away_team_link</span><span class="p">:</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">45</span><span class="p">:</span>
                <span class="n">away_team_scores_firsthalf</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">45</span><span class="p">:</span>
                <span class="n">away_team_scores_secondhalf</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">away_team_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="n">away_team_scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
        <span class="n">away_team_scores_firsthalf</span> <span class="o">=</span> <span class="mi">99</span>
        <span class="n">away_team_scores_secondhalf</span> <span class="o">=</span> <span class="mi">99</span>

    <span class="k">return</span><span class="p">(</span><span class="n">home_team_scores_firsthalf</span><span class="p">,</span> <span class="n">home_team_scores_secondhalf</span><span class="p">,</span> <span class="n">away_team_scores_firsthalf</span><span class="p">,</span> <span class="n">away_team_scores_secondhalf</span><span class="p">)</span>
</pre></div>


<p>The <em>teams</em> list will now have all the information we needed. </p>
<div class="highlight"><pre><span></span><span class="n">all_matches</span> <span class="o">=</span> <span class="n">get_html</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
</pre></div>


<p><code>[['Sun',
  'May 19',
  'Eibar',
  'Barça',
  '2',
  '2',
  2,
  0,
  2,
  0,
  'https://www.msn.com/en-us/sports/soccer/la-liga/eibar-v-barcelona/game-center/sp-id-80402000001009693',
  '39',
  '61',
  '18',
  '8',
  '8',
  '3',
  '17',
  '5',
  '5',
  '2',
  '1',
  '6',
  None,
  None,
  '4',
  '2',
  '0',
  '0'],
 ['Sun',
  'May 19',
  'Real Madrid',
  'Betis',
  '0',
  '2',
  0,
  0,
  0,
  2,
  'https://www.msn.com/en-us/sports/soccer/la-liga/real-madrid-v-real-betis/game-center/sp-id-80402000001009694',
  '47',
  '53',
  '9',
  '9',
  '2',
  '7',
  '18',
  '10',
  '1',
  '5',
  '5',
  '2',
  '1',
  '4',
  '4',
  '1',
  '0',
  '0'],...]</code></p>
<p>Now we can very simply convert into a dataframe and start analyzing!</p>
<div class="highlight"><pre><span></span><span class="n">cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;match_day&#39;</span><span class="p">,</span> <span class="s1">&#39;match_date&#39;</span><span class="p">,</span> <span class="s1">&#39;home_team&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team&#39;</span><span class="p">,</span> <span class="s1">&#39;home_team_score&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team_score&#39;</span><span class="p">,</span> <span class="s1">&#39;HT_num_goals_firsthalf&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;HT_num_goals_secondhalf&#39;</span><span class="p">,</span> <span class="s1">&#39;AT_num_goals_firsthalf&#39;</span><span class="p">,</span> <span class="s1">&#39;AT_num_goals_secondhalf&#39;</span><span class="p">,</span> <span class="s1">&#39;match_link&#39;</span><span class="p">,</span> <span class="s1">&#39;home_posession&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;away_posession&#39;</span><span class="p">,</span> <span class="s1">&#39;home_shots&#39;</span><span class="p">,</span> <span class="s1">&#39;away_shots&#39;</span><span class="p">,</span> <span class="s1">&#39;home_shots_ontarget&#39;</span><span class="p">,</span> <span class="s1">&#39;away_shots_ontarget&#39;</span><span class="p">,</span> <span class="s1">&#39;home_fouls&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;away_fouls&#39;</span><span class="p">,</span> <span class="s1">&#39;home_corners&#39;</span><span class="p">,</span> <span class="s1">&#39;away_corners&#39;</span><span class="p">,</span> <span class="s1">&#39;home_saves&#39;</span><span class="p">,</span> <span class="s1">&#39;away_saves&#39;</span><span class="p">,</span> <span class="s1">&#39;home_offsides&#39;</span><span class="p">,</span> <span class="s1">&#39;away_offsides&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;home_yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;away_yellow&#39;</span><span class="p">,</span> <span class="s1">&#39;home_red&#39;</span><span class="p">,</span> <span class="s1">&#39;away_red&#39;</span><span class="p">]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">all_matches</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">cols</span><span class="p">)</span>
</pre></div>


<p><img alt="image" src="images/laliga-df.jpg"></p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/data-preprocessing.html" rel="bookmark"
                           title="Permalink to Data Preprocessing">Data Preprocessing</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-11-14T00:00:00-05:00">
                Published: Wed 14 November 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <p><img alt="image" src="images/ml.png"></p>
<p>It was 6 pm on October 17th, 2018, when the wind came crashing at my window. I woke up from my little nap and as usual — I picked up my phone and went to YouTube. Well thanks to YouTube for recommending me this Siraj Raval’s video, where he simply …</p>
                <a class="readmore" href="/data-preprocessing.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/anscombes-quartet.html" rel="bookmark"
                           title="Permalink to Anscombe's Quartet">Anscombe's Quartet</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-19T00:00:00-04:00">
                Published: Wed 19 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/misc.html">misc</a>.</p>

</footer><!-- /.post-info -->                <p>I always believed in “numerical calculations are exact, but graphs are rough”. Coming from a person who has just started learning Data Analytics, it was hard for me to understand the importance of Data Visualization along with summary statistics. But it all changed after attending this Data Visualization Meetup, which …</p>
                <a class="readmore" href="/anscombes-quartet.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>