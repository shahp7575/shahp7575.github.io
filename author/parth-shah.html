<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Parth Shah - Parth Shah</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Parth Shah Atom Feed" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">Parth Shah </a></h1>
                <nav><ul>
                    <li><a href="/pages/about-me.html">About Me</a></li>
                    <li><a href="/category/blog.html">Blog</a></li>
                </ul></nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="/analyzing-teen-gambling-and-prostate-cancer-dataset-using-r.html">Analyzing Teen Gambling and Prostate Cancer dataset using R</a></h1>
<footer class="post-info">
        <abbr class="published" title="2019-09-13T00:00:00-04:00">
                Published: Fri 13 September 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info --><p>This Fall I started my masters in data science at Rutgers University. In one of my <em>Time Series and Regression</em> assignment, we were asked to analyze two datasets: <em>teengamb</em> and <em>prostate</em> using R. This was my first time experimenting with R and it turned out to be a great learning experience.</p>
<h2>Problem 1: Analyzing dataset teengamb</h2>
<h3>Loading data &amp; libraries</h3>
<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>faraway<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>purrr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggplot2<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>ggpubr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>repr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>reshape2<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>Attaching package: &#39;tidyr&#39;

The following object is masked from &#39;package:reshape2&#39;:

    smiths

The following object is masked from &#39;package:magrittr&#39;:

    extract
</pre></div>


<div class="highlight"><pre><span></span>data<span class="p">(</span>teengamb<span class="p">)</span>
df <span class="o">=</span> teengamb
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>df<span class="p">);</span> <span class="kp">tail</span><span class="p">(</span>df<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th scope=col>sex</th><th scope=col>status</th><th scope=col>income</th><th scope=col>verbal</th><th scope=col>gamble</th></tr></thead>
<tbody>
    <tr><td>1   </td><td>51  </td><td>2.00</td><td>8   </td><td> 0.0</td></tr>
    <tr><td>1   </td><td>28  </td><td>2.50</td><td>8   </td><td> 0.0</td></tr>
    <tr><td>1   </td><td>37  </td><td>2.00</td><td>6   </td><td> 0.0</td></tr>
    <tr><td>1   </td><td>28  </td><td>7.00</td><td>4   </td><td> 7.3</td></tr>
    <tr><td>1   </td><td>65  </td><td>2.00</td><td>8   </td><td>19.6</td></tr>
    <tr><td>1   </td><td>61  </td><td>3.47</td><td>6   </td><td> 0.1</td></tr>
</tbody>
</table>

<table>
<thead><tr><th></th><th scope=col>sex</th><th scope=col>status</th><th scope=col>income</th><th scope=col>verbal</th><th scope=col>gamble</th></tr></thead>
<tbody>
    <tr><th scope=row>42</th><td>0    </td><td>61   </td><td>15.00</td><td>9    </td><td>69.7 </td></tr>
    <tr><th scope=row>43</th><td>0    </td><td>75   </td><td> 3.00</td><td>8    </td><td>13.3 </td></tr>
    <tr><th scope=row>44</th><td>0    </td><td>66   </td><td> 3.25</td><td>9    </td><td> 0.6 </td></tr>
    <tr><th scope=row>45</th><td>0    </td><td>62   </td><td> 4.94</td><td>6    </td><td>38.0 </td></tr>
    <tr><th scope=row>46</th><td>0    </td><td>71   </td><td> 1.50</td><td>7    </td><td>14.4 </td></tr>
    <tr><th scope=row>47</th><td>0    </td><td>71   </td><td> 2.50</td><td>9    </td><td>19.2 </td></tr>
</tbody>
</table>

<h3>Numerical analysis</h3>
<div class="highlight"><pre><span></span><span class="kp">summary</span><span class="p">(</span>df<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>      sex             status          income           verbal     
 Min.   :0.0000   Min.   :18.00   Min.   : 0.600   Min.   : 1.00  
 1st Qu.:0.0000   1st Qu.:28.00   1st Qu.: 2.000   1st Qu.: 6.00  
 Median :0.0000   Median :43.00   Median : 3.250   Median : 7.00  
 Mean   :0.4043   Mean   :45.23   Mean   : 4.642   Mean   : 6.66  
 3rd Qu.:1.0000   3rd Qu.:61.50   3rd Qu.: 6.210   3rd Qu.: 8.00  
 Max.   :1.0000   Max.   :75.00   Max.   :15.000   Max.   :10.00  
     gamble     
 Min.   :  0.0  
 1st Qu.:  1.1  
 Median :  6.0  
 Mean   : 19.3  
 3rd Qu.: 19.4  
 Max.   :156.0
</pre></div>


<ul>
<li><em>sex</em> - It is considered as numeric here. So it needs to be converted to a categorical attribute.</li>
<li><em>status</em> - Seems like a normal distribution as the mean and median is concentrated in the center.</li>
<li><em>income</em> - Here the mean and median is closer to the minimum. So this might represent a right-skewed distribution.</li>
<li><em>verbal</em> - Mean, median is slightly closer to the maximum. So it could be slightly left-skewed.</li>
<li><em>gamble</em> - With mean(19.3) &gt; median(6.0), this is heavily skewed to the right.</li>
</ul>
<div class="highlight"><pre><span></span>df<span class="o">$</span>sex <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>df<span class="o">$</span>sex<span class="p">,</span> levels<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">),</span> labels<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;male&quot;</span><span class="p">,</span> <span class="s">&quot;female&quot;</span><span class="p">));</span> <span class="kp">summary</span><span class="p">(</span>df<span class="o">$</span>sex<span class="p">)</span>
</pre></div>


<dl class=dl-horizontal>
    <dt>male</dt>
        <dd>28</dd>
    <dt>female</dt>
        <dd>19</dd>
</dl>

<div class="highlight"><pre><span></span><span class="c1"># Check for NAs</span>
<span class="kp">apply</span><span class="p">(</span>df<span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="kp">any</span><span class="p">(</span><span class="kp">is.na</span><span class="p">(</span>x<span class="p">)))</span>
</pre></div>


<dl class=dl-horizontal>
    <dt>sex</dt>
        <dd>FALSE</dd>
    <dt>status</dt>
        <dd>FALSE</dd>
    <dt>income</dt>
        <dd>FALSE</dd>
    <dt>verbal</dt>
        <dd>FALSE</dd>
    <dt>gamble</dt>
        <dd>FALSE</dd>
</dl>

<p>None of the columns in the dataset have null values.</p>
<h3>Univariate Analysis</h3>
<h4>Status</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">)</span> <span class="o">+</span> geom_histogram<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>status<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> bins<span class="o">=</span><span class="m">10</span><span class="p">)</span> <span class="o">+</span> 
                    geom_density<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>status<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> color<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Histogram of Status&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span> panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
                        panel.background <span class="o">=</span> element_blank<span class="p">(),</span> axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_11_0.png"></p>
<ul>
<li>As per the numerical analysis it was assumed that <em>status</em> follows a normal distribution. But the histogram above shows a slight bimodal distribution instead. This depicts that the social economic status is almost equally distributed across the entire dataset.</li>
</ul>
<h4>Income</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">)</span> <span class="o">+</span> geom_histogram<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>income<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> bins<span class="o">=</span><span class="m">15</span><span class="p">)</span> <span class="o">+</span> 
                    geom_density<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>income<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> color<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Histogram of Income&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span> panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
                        panel.background <span class="o">=</span> element_blank<span class="p">(),</span> axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_14_0.png"></p>
<ul>
<li>As assumed the distribution is right-skewed which shows that most of the people in the dataset have a low-mid range income per week.</li>
</ul>
<h4>Verbal</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">)</span> <span class="o">+</span> geom_histogram<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>verbal<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> bins<span class="o">=</span><span class="m">10</span><span class="p">)</span> <span class="o">+</span> 
                    geom_density<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>verbal<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> color<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Histogram of Verbal&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span> panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
                        panel.background <span class="o">=</span> element_blank<span class="p">(),</span> axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_17_0.png"></p>
<ul>
<li>The histogram of <em>verbal</em> is slightly left skewed showing that there are very few people with low verbal scores.</li>
</ul>
<h4>Gamble</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">)</span> <span class="o">+</span> geom_histogram<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>gamble<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> bins<span class="o">=</span><span class="m">15</span><span class="p">)</span> <span class="o">+</span> 
                    geom_density<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>gamble<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> color<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Histogram of Gamble&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span> panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
                        panel.background <span class="o">=</span> element_blank<span class="p">(),</span> axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_20_0.png"></p>
<ul>
<li>As per the assumption in numerical analysis, the histogram of <em>gamble</em> is heavily skewed to the right. It represents that most of the people gamble less money while there are some who gamble over 80.00 pounds per year.</li>
</ul>
<p>Also there seems to be a huge gap at the far end of the distribution.</p>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
plot<span class="p">(</span><span class="kp">sort</span><span class="p">(</span>df<span class="o">$</span>gamble<span class="p">),</span> ylab<span class="o">=</span><span class="s">&quot;Gamble&quot;</span><span class="p">,</span> main <span class="o">=</span> <span class="s">&quot;Index plot Gamble&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_22_0.png"></p>
<p>The linear model would be more accurate without this outlier, hence it is removed.</p>
<div class="highlight"><pre><span></span>df<span class="o">$</span>gamble<span class="p">[</span>df<span class="o">$</span>gamble <span class="o">==</span> <span class="kp">max</span><span class="p">(</span>df<span class="o">$</span>gamble<span class="p">)]</span> <span class="o">=</span> <span class="kc">NA</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># removing NAs</span>
na_rows <span class="o">=</span> <span class="kp">apply</span><span class="p">(</span>df<span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="kr">function</span><span class="p">(</span>x<span class="p">)</span> <span class="kp">any</span><span class="p">(</span><span class="kp">is.na</span><span class="p">(</span>x<span class="p">)))</span>
df <span class="o">&lt;-</span> df<span class="p">[</span><span class="o">!</span>na_rows<span class="p">,]</span>
</pre></div>


<h3>Bivariate Analysis</h3>
<h4>Sex vs Gamble</h4>
<div class="highlight"><pre><span></span>fill <span class="o">&lt;-</span> <span class="s">&quot;#4271AE&quot;</span>
line <span class="o">&lt;-</span> <span class="s">&quot;#1F3552&quot;</span>

<span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>sex<span class="p">,</span> y<span class="o">=</span>gamble<span class="p">))</span> <span class="o">+</span> geom_boxplot<span class="p">(</span>fill<span class="o">=</span>fill<span class="p">,</span> colour<span class="o">=</span>line<span class="p">,</span> alpha<span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Sex vs Gamble&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_28_0.png"></p>
<p>We can observe how the median for males is very separated from that of the females, which shows that males tend to spend more on gambling than females. Also the median for males is leaned towards <strong>Q1</strong> representing that most of the males spend between 0 to 15 pounds per year on gambling. While there are very few of them who spend above 25 pounds per year, hence skewed to the right.</p>
<h4>Status vs Gamble</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>status<span class="p">,</span> y<span class="o">=</span>gamble<span class="p">))</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> geom_smooth<span class="p">(</span>method <span class="o">=</span> <span class="s">&#39;lm&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Status vs Gamble&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_31_0.png"></p>
<p>While an upward trend is observed depicting that people with higher status tend to gamble more, however, there are few people within low status that spend considerably more in gambling. In fact, most of the highest expenditure on gambling are from people within the low status.</p>
<h4>Income vs Gamble</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>income<span class="p">,</span> y<span class="o">=</span>gamble<span class="p">))</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> geom_smooth<span class="p">(</span>method <span class="o">=</span> <span class="s">&#39;lm&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Income vs Gamble&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_34_0.png"></p>
<p>A nice upward trend is observed showing that people with higher income tend to spend more on gambling. Also we can observe below that even though males and females approximately have the same income, males tend to spend considerably more on gambling.</p>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggscatterhist<span class="p">(</span>
  df<span class="p">,</span> x <span class="o">=</span> <span class="s">&quot;income&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;gamble&quot;</span><span class="p">,</span>
  color <span class="o">=</span> <span class="s">&quot;sex&quot;</span><span class="p">,</span> size <span class="o">=</span> <span class="m">3</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
  palette <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;#00AFBB&quot;</span><span class="p">,</span> <span class="s">&quot;#E7B800&quot;</span><span class="p">,</span> <span class="s">&quot;#FC4E07&quot;</span><span class="p">),</span>
  margin.plot <span class="o">=</span> <span class="s">&quot;boxplot&quot;</span><span class="p">,</span>
  ggtheme <span class="o">=</span> theme_bw<span class="p">()</span>
  <span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_36_0.png"></p>
<h4>Verbal vs Gamble</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span><span class="kp">factor</span><span class="p">(</span>df<span class="o">$</span>verbal<span class="p">),</span> y<span class="o">=</span>gamble<span class="p">,</span> color<span class="o">=</span><span class="kp">factor</span><span class="p">(</span>df<span class="o">$</span>verbal<span class="p">)))</span> <span class="o">+</span> geom_boxplot<span class="p">(</span>alpha<span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Verbal Score vs Gamble&quot;</span><span class="p">)</span> <span class="o">+</span> xlab<span class="p">(</span><span class="s">&#39;Verbal Scores&#39;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span> legend.position <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_38_0.png"></p>
<p>It can be observed that people with average verbal scores(5-8) tend to gamble more than the others. But this trend could also be because of the fact that most of the people in the dataset have above average verbal scores.</p>
<h3>Heatmap</h3>
<div class="highlight"><pre><span></span>corr <span class="o">&lt;-</span> <span class="kp">round</span><span class="p">(</span>cor<span class="p">(</span>teengamb<span class="p">),</span> <span class="m">2</span><span class="p">)</span>
melt_df <span class="o">&lt;-</span> melt<span class="p">(</span>corr<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">6</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data<span class="o">=</span>melt_df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>Var1<span class="p">,</span> y<span class="o">=</span>Var2<span class="p">,</span> fill<span class="o">=</span>value<span class="p">))</span> <span class="o">+</span> 
            geom_tile<span class="p">(</span>color<span class="o">=</span><span class="s">&#39;white&#39;</span><span class="p">)</span> <span class="o">+</span> 
            scale_fill_gradient2<span class="p">(</span>low <span class="o">=</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> high <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> mid <span class="o">=</span> <span class="s">&quot;white&quot;</span><span class="p">,</span> midpoint <span class="o">=</span> <span class="m">0</span><span class="p">,</span> limit <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> space <span class="o">=</span> <span class="s">&quot;Lab&quot;</span><span class="p">,</span> 
               name<span class="o">=</span><span class="s">&quot;Pearson\nCorrelation&quot;</span><span class="p">)</span> <span class="o">+</span>
            theme_minimal<span class="p">()</span> <span class="o">+</span>
            theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">45</span><span class="p">,</span> vjust <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                size <span class="o">=</span> <span class="m">12</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span><span class="o">+</span>
                coord_fixed<span class="p">()</span>
</pre></div>


<p><img alt="png" src="images/output_42_0.png"></p>
<ul>
<li>As observed <em>income</em> is positively correlated to <em>gamble</em>, while other features doesn't seem to be well correlated to <em>gamble</em>.</li>
<li>The other interesting feature is the positive correlation between <em>status</em> and <em>verbal</em>, showing that people with high status tend to have higher verbal scores.</li>
</ul>
<h3>Fitting Linear Model</h3>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
plot<span class="p">(</span>gamble <span class="o">~</span> income<span class="p">,</span> df<span class="p">)</span>
abline<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
g <span class="o">&lt;-</span> lm<span class="p">(</span>gamble <span class="o">~</span> income<span class="p">,</span> df<span class="p">)</span>
abline<span class="p">(</span>coef<span class="p">(</span>g<span class="p">),</span> lty<span class="o">=</span><span class="m">5</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_45_0.png"></p>
<h2>Problem 2: Analyzing dataset prostate</h2>
<div class="highlight"><pre><span></span>data<span class="p">(</span>prostate<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">head</span><span class="p">(</span>prostate<span class="p">);</span> <span class="kp">tail</span><span class="p">(</span>prostate<span class="p">)</span>
</pre></div>


<table>
<thead><tr><th scope=col>lcavol</th><th scope=col>lweight</th><th scope=col>age</th><th scope=col>lbph</th><th scope=col>svi</th><th scope=col>lcp</th><th scope=col>gleason</th><th scope=col>pgg45</th><th scope=col>lpsa</th></tr></thead>
<tbody>
    <tr><td>-0.5798185</td><td>2.7695    </td><td>50        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>6         </td><td> 0        </td><td>-0.43078  </td></tr>
    <tr><td>-0.9942523</td><td>3.3196    </td><td>58        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>6         </td><td> 0        </td><td>-0.16252  </td></tr>
    <tr><td>-0.5108256</td><td>2.6912    </td><td>74        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>7         </td><td>20        </td><td>-0.16252  </td></tr>
    <tr><td>-1.2039728</td><td>3.2828    </td><td>58        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>6         </td><td> 0        </td><td>-0.16252  </td></tr>
    <tr><td> 0.7514161</td><td>3.4324    </td><td>62        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>6         </td><td> 0        </td><td> 0.37156  </td></tr>
    <tr><td>-1.0498221</td><td>3.2288    </td><td>50        </td><td>-1.386294 </td><td>0         </td><td>-1.38629  </td><td>6         </td><td> 0        </td><td> 0.76547  </td></tr>
</tbody>
</table>

<table>
<thead><tr><th></th><th scope=col>lcavol</th><th scope=col>lweight</th><th scope=col>age</th><th scope=col>lbph</th><th scope=col>svi</th><th scope=col>lcp</th><th scope=col>gleason</th><th scope=col>pgg45</th><th scope=col>lpsa</th></tr></thead>
<tbody>
    <tr><th scope=row>92</th><td>2.532903 </td><td>3.6776   </td><td>61       </td><td> 1.348073</td><td>1        </td><td>-1.38629 </td><td>7        </td><td>15       </td><td>4.12955  </td></tr>
    <tr><th scope=row>93</th><td>2.830268 </td><td>3.8764   </td><td>68       </td><td>-1.386294</td><td>1        </td><td> 1.32176 </td><td>7        </td><td>60       </td><td>4.38515  </td></tr>
    <tr><th scope=row>94</th><td>3.821004 </td><td>3.8969   </td><td>44       </td><td>-1.386294</td><td>1        </td><td> 2.16905 </td><td>7        </td><td>40       </td><td>4.68444  </td></tr>
    <tr><th scope=row>95</th><td>2.907447 </td><td>3.3962   </td><td>52       </td><td>-1.386294</td><td>1        </td><td> 2.46385 </td><td>7        </td><td>10       </td><td>5.14312  </td></tr>
    <tr><th scope=row>96</th><td>2.882564 </td><td>3.7739   </td><td>68       </td><td> 1.558145</td><td>1        </td><td> 1.55814 </td><td>7        </td><td>80       </td><td>5.47751  </td></tr>
    <tr><th scope=row>97</th><td>3.471967 </td><td>3.9750   </td><td>68       </td><td> 0.438255</td><td>1        </td><td> 2.90417 </td><td>7        </td><td>20       </td><td>5.58293  </td></tr>
</tbody>
</table>

<h3>Numerical Analysis</h3>
<div class="highlight"><pre><span></span><span class="kp">summary</span><span class="p">(</span>prostate<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>     <span class="s s-Atom">lcavol</span>           <span class="s s-Atom">lweight</span>           <span class="s s-Atom">age</span>             <span class="s s-Atom">lbph</span>         <span class="s s-Atom">svi</span>   
 <span class="nv">Min</span><span class="p">.</span>   <span class="p">:-</span><span class="mf">1.3471</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">2.375</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">41.00</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="p">:-</span><span class="mf">1.3863</span>   <span class="mi">0</span><span class="s s-Atom">:</span><span class="mi">76</span>  
 <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">0.5128</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">3.376</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">60.00</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.:-</span><span class="mf">1.3863</span>   <span class="mi">1</span><span class="s s-Atom">:</span><span class="mi">21</span>  
 <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">1.4469</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">3.623</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span><span class="mf">65.00</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">0.3001</span>         
 <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">1.3500</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">3.653</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span><span class="mf">63.87</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">0.1004</span>         
 <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">2.1270</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">3.878</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span><span class="mf">68.00</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">1.5581</span>         
 <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">3.8210</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">6.108</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">79.00</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">2.3263</span>         
      <span class="s s-Atom">lcp</span>          <span class="s s-Atom">gleason</span>     <span class="s s-Atom">pgg45</span>             <span class="s s-Atom">lpsa</span>        
 <span class="nv">Min</span><span class="p">.</span>   <span class="p">:-</span><span class="mf">1.3863</span>   <span class="mi">6</span><span class="s s-Atom">:</span><span class="mi">35</span>    <span class="nv">Min</span><span class="p">.</span>   <span class="s s-Atom">:</span>  <span class="mf">0.00</span>   <span class="nv">Min</span><span class="p">.</span>   <span class="p">:-</span><span class="mf">0.4308</span>  
 <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.:-</span><span class="mf">1.3863</span>   <span class="mi">7</span><span class="s s-Atom">:</span><span class="mi">56</span>    <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span>  <span class="mf">0.00</span>   <span class="mi">1</span><span class="s s-Atom">st</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">1.7317</span>  
 <span class="nv">Median</span> <span class="p">:-</span><span class="mf">0.7985</span>   <span class="mi">8</span><span class="s s-Atom">:</span> <span class="mi">1</span>    <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">15.00</span>   <span class="nv">Median</span> <span class="s s-Atom">:</span> <span class="mf">2.5915</span>  
 <span class="nv">Mean</span>   <span class="p">:-</span><span class="mf">0.1794</span>   <span class="mi">9</span><span class="s s-Atom">:</span> <span class="mi">5</span>    <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">24.38</span>   <span class="nv">Mean</span>   <span class="s s-Atom">:</span> <span class="mf">2.4784</span>  
 <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">1.1786</span>           <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">40.00</span>   <span class="mi">3</span><span class="s s-Atom">rd</span> <span class="nv">Qu</span><span class="p">.</span><span class="s s-Atom">:</span> <span class="mf">3.0564</span>  
 <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">2.9042</span>           <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span><span class="mf">100.00</span>   <span class="nv">Max</span><span class="p">.</span>   <span class="s s-Atom">:</span> <span class="mf">5.5829</span>
</pre></div>


<ul>
<li><em>svi</em>, <em>gleason</em> seems to be categorical variables, so they are converted to categories using <code>factor</code>.</li>
<li><em>pgg45</em> seems to be heavily skewed to the right, while other features have their mean and median concentrated at the center.</li>
</ul>
<div class="highlight"><pre><span></span>prostate<span class="o">$</span>svi <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>prostate<span class="o">$</span>svi<span class="p">)</span>
prostate<span class="o">$</span>gleason <span class="o">=</span> <span class="kp">factor</span><span class="p">(</span>prostate<span class="o">$</span>gleason<span class="p">)</span>
</pre></div>


<h3>Univariate Analysis</h3>
<div class="highlight"><pre><span></span><span class="c1"># creating common ggplot function</span>
prostate_histogram <span class="o">&lt;-</span> <span class="kr">function</span><span class="p">(</span>data<span class="p">,</span> x<span class="p">,</span> plot_title<span class="p">,</span> bins<span class="p">)</span>
    <span class="p">{</span>
        <span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
        p <span class="o">&lt;-</span> ggplot<span class="p">(</span>data <span class="o">=</span> data<span class="p">)</span>
        p <span class="o">+</span> geom_histogram<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>x<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> bins<span class="o">=</span>bins<span class="p">)</span> <span class="o">+</span> 
            geom_density<span class="p">(</span>aes<span class="p">(</span>x<span class="o">=</span>x<span class="p">,</span> y<span class="o">=</span><span class="m">..</span>density..<span class="p">),</span> color<span class="o">=</span><span class="s">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
            ggtitle<span class="p">(</span>plot_title<span class="p">)</span> <span class="o">+</span>
            theme<span class="p">(</span>panel.grid.major <span class="o">=</span> element_blank<span class="p">(),</span> panel.grid.minor <span class="o">=</span> element_blank<span class="p">(),</span>
                panel.background <span class="o">=</span> element_blank<span class="p">(),</span> axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>       
<span class="p">}</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="c1"># plotting histograms of all numeric features</span>
d <span class="o">&lt;-</span> prostate
<span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">6</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
d <span class="o">%&gt;%</span>
  keep<span class="p">(</span><span class="kp">is.numeric</span><span class="p">)</span> <span class="o">%&gt;%</span>                     <span class="c1"># Keep only numeric columns</span>
  gather<span class="p">()</span> <span class="o">%&gt;%</span>                             <span class="c1"># Convert to key-value pairs</span>
  ggplot<span class="p">(</span>aes<span class="p">(</span>value<span class="p">))</span> <span class="o">+</span>                     <span class="c1"># Plot the values</span>
    facet_wrap<span class="p">(</span><span class="o">~</span> key<span class="p">,</span> scales <span class="o">=</span> <span class="s">&quot;free&quot;</span><span class="p">)</span> <span class="o">+</span>
    geom_histogram<span class="p">(</span>bins<span class="o">=</span><span class="m">12</span><span class="p">)</span> 
</pre></div>


<p><img alt="png" src="images/output_55_0.png"></p>
<ul>
<li><em>lbph</em> - Seems to have many features capped at $-1.386294$. Maybe it is the default value placed just in case it's missing.</li>
<li><em>lcp</em> - Just like <em>lbph</em>, it has many features capped at $-1.38629$ as well.</li>
<li><em>lweight</em> - Follows a normal distribution except for an outlier at $6.1076$.</li>
<li><em>pgg45</em> - As assumed it is heavily skewed to the right.</li>
</ul>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
plot<span class="p">(</span><span class="kp">sort</span><span class="p">(</span>prostate<span class="o">$</span>lweight<span class="p">),</span> ylab<span class="o">=</span><span class="s">&quot;lweight&quot;</span><span class="p">,</span> main <span class="o">=</span> <span class="s">&quot;Index plot lweight&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_57_0.png"></p>
<ul>
<li>The outlier may be removed if it correlates well with the response feature <em>lpsa</em></li>
</ul>
<h3>Bivariate Analysis</h3>
<h4>Log(Cancer Volume) vs Log(Prostate Specific Antigen)</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> prostate<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>lcavol<span class="p">,</span> y<span class="o">=</span>lpsa<span class="p">))</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> geom_smooth<span class="p">(</span>method <span class="o">=</span> <span class="s">&#39;lm&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Log(Cancer Volume) vs Log(Prostate Specific Antigen)&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_61_0.png"></p>
<p><em>lcavol</em> and <em>lpsa</em> are highly positively correlated. It shows that increase in the Log(Cancer Volume) leads to increase in the Log(Prostate Specific Antigen)</p>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggscatterhist<span class="p">(</span>
  prostate<span class="p">,</span> x <span class="o">=</span> <span class="s">&quot;lcavol&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;lpsa&quot;</span><span class="p">,</span>
  color <span class="o">=</span> <span class="s">&quot;svi&quot;</span><span class="p">,</span> size <span class="o">=</span> <span class="m">3</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
  palette <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;#00AFBB&quot;</span><span class="p">,</span> <span class="s">&quot;#E7B800&quot;</span><span class="p">,</span> <span class="s">&quot;#FC4E07&quot;</span><span class="p">),</span>
  margin.plot <span class="o">=</span> <span class="s">&quot;boxplot&quot;</span><span class="p">,</span>
  ggtheme <span class="o">=</span> theme_bw<span class="p">()</span>
  <span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_63_0.png"></p>
<p>Patients with <em>seminal vesicle invasion</em> have higher <em>Log(Cancer Volume)</em>. Also those patients with <em>svi</em> and higher <em>Log(Cancer Volume)</em> also seem to have higher Log(Prostate Specific Antigen).</p>
<h4>Log(Capsular Penetration) vs Log(Prostate Specific Antigen)</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> prostate<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>lcp<span class="p">,</span> y<span class="o">=</span>lpsa<span class="p">))</span> <span class="o">+</span> geom_point<span class="p">()</span> <span class="o">+</span> geom_smooth<span class="p">(</span>method <span class="o">=</span> <span class="s">&#39;lm&#39;</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;Log(Capsular Penetration) vs Log(Prostate Specific Antigen)&quot;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">))</span>
</pre></div>


<p><img alt="png" src="images/output_66_0.png"></p>
<p><em>Log(Capsular Penetration)</em> and <em>Log(Prostate Specific Antigen)</em> seems to be positively correlated as well. However as most of the features in <em>lcp</em> are capped at $-1.38629$, it needs more information.</p>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggscatterhist<span class="p">(</span>
  prostate<span class="p">,</span> x <span class="o">=</span> <span class="s">&quot;lcp&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;lpsa&quot;</span><span class="p">,</span>
  color <span class="o">=</span> <span class="s">&quot;svi&quot;</span><span class="p">,</span> size <span class="o">=</span> <span class="m">3</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
  palette <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;#00AFBB&quot;</span><span class="p">,</span> <span class="s">&quot;#E7B800&quot;</span><span class="p">,</span> <span class="s">&quot;#FC4E07&quot;</span><span class="p">),</span>
  margin.plot <span class="o">=</span> <span class="s">&quot;boxplot&quot;</span><span class="p">,</span>
  ggtheme <span class="o">=</span> theme_bw<span class="p">()</span>
  <span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_68_0.png"></p>
<p>Patients with <em>svi</em> do seem to have higher <em>Log(Capsular Penetration)</em>. Just as <em>lcavol</em>, if patients have both <em>svi</em> and higher <em>lcp</em>, then they are likely to have higher <em>lpsa</em>.</p>
<h4>svi vs lpsa</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data <span class="o">=</span> prostate<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>prostate<span class="o">$</span>svi<span class="p">,</span> y<span class="o">=</span>lpsa<span class="p">,</span> color<span class="o">=</span>prostate<span class="o">$</span>svi<span class="p">))</span> <span class="o">+</span> geom_boxplot<span class="p">(</span>alpha<span class="o">=</span><span class="m">0.7</span><span class="p">)</span> <span class="o">+</span>
                    ggtitle<span class="p">(</span><span class="s">&quot;SVI vs LPSA&quot;</span><span class="p">)</span> <span class="o">+</span> xlab<span class="p">(</span><span class="s">&#39;SVI&#39;</span><span class="p">)</span> <span class="o">+</span>
                    theme<span class="p">(</span>axis.line <span class="o">=</span> element_line<span class="p">(</span>colour <span class="o">=</span> <span class="s">&quot;black&quot;</span><span class="p">),</span> legend.position <span class="o">=</span> <span class="s">&quot;none&quot;</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_71_0.png"></p>
<p>The median of patients with and without <em>svi</em> are well separated. Patients with <em>svi</em> are likely to have higher <em>lpsa</em>.</p>
<h4>Percentage Gleason Scores vs LPSA</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">5</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
ggscatterhist<span class="p">(</span>
  prostate<span class="p">,</span> x <span class="o">=</span> <span class="s">&quot;pgg45&quot;</span><span class="p">,</span> y <span class="o">=</span> <span class="s">&quot;lpsa&quot;</span><span class="p">,</span>
  color <span class="o">=</span> <span class="s">&quot;gleason&quot;</span><span class="p">,</span> size <span class="o">=</span> <span class="m">3</span><span class="p">,</span> alpha <span class="o">=</span> <span class="m">0.6</span><span class="p">,</span>
  palette <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="s">&quot;#00AFBB&quot;</span><span class="p">,</span> <span class="s">&quot;#E7B800&quot;</span><span class="p">,</span> <span class="s">&quot;#FC4E07&quot;</span><span class="p">,</span> <span class="s">&quot;#11BC11&quot;</span><span class="p">),</span>
  margin.plot <span class="o">=</span> <span class="s">&quot;boxplot&quot;</span><span class="p">,</span>
  ggtheme <span class="o">=</span> theme_bw<span class="p">()</span>
  <span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_74_0.png"></p>
<p>As <em>pgg45</em> is the percentage score of <em>gleason</em>, it increases as <em>gleason</em> increases. Also <em>gleason</em> score of 7,8,9 seems to have a slightly higher <em>lpsa</em> in comparison to that of 6.</p>
<div class="highlight"><pre><span></span>
</pre></div>


<h3>Heatmap</h3>
<div class="highlight"><pre><span></span>df2 <span class="o">&lt;-</span> data<span class="p">(</span>prostate<span class="p">)</span>
corr <span class="o">&lt;-</span> <span class="kp">round</span><span class="p">(</span>cor<span class="p">(</span>prostate<span class="p">),</span> <span class="m">2</span><span class="p">)</span>
melt_df <span class="o">&lt;-</span> melt<span class="p">(</span>corr<span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">6</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">3</span><span class="p">)</span>
ggplot<span class="p">(</span>data<span class="o">=</span>melt_df<span class="p">,</span> aes<span class="p">(</span>x<span class="o">=</span>Var1<span class="p">,</span> y<span class="o">=</span>Var2<span class="p">,</span> fill<span class="o">=</span>value<span class="p">))</span> <span class="o">+</span> 
            geom_tile<span class="p">(</span>color<span class="o">=</span><span class="s">&#39;white&#39;</span><span class="p">)</span> <span class="o">+</span> 
            scale_fill_gradient2<span class="p">(</span>low <span class="o">=</span> <span class="s">&quot;blue&quot;</span><span class="p">,</span> high <span class="o">=</span> <span class="s">&quot;red&quot;</span><span class="p">,</span> mid <span class="o">=</span> <span class="s">&quot;white&quot;</span><span class="p">,</span> midpoint <span class="o">=</span> <span class="m">0</span><span class="p">,</span> limit <span class="o">=</span> <span class="kt">c</span><span class="p">(</span><span class="m">-1</span><span class="p">,</span><span class="m">1</span><span class="p">),</span> space <span class="o">=</span> <span class="s">&quot;Lab&quot;</span><span class="p">,</span> 
               name<span class="o">=</span><span class="s">&quot;Pearson\nCorrelation&quot;</span><span class="p">)</span> <span class="o">+</span>
            theme_minimal<span class="p">()</span> <span class="o">+</span>
            theme<span class="p">(</span>axis.text.x <span class="o">=</span> element_text<span class="p">(</span>angle <span class="o">=</span> <span class="m">45</span><span class="p">,</span> vjust <span class="o">=</span> <span class="m">1</span><span class="p">,</span> 
                size <span class="o">=</span> <span class="m">12</span><span class="p">,</span> hjust <span class="o">=</span> <span class="m">1</span><span class="p">))</span><span class="o">+</span>
                coord_fixed<span class="p">()</span>
</pre></div>


<p><img alt="png" src="images/output_79_0.png"></p>
<p><em>lcavol, svi, lcp</em> are positively correlated to <em>lpsa</em>.</p>
<h3>Fitting linear model</h3>
<h4>lpsa ~ lcavol</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
plot<span class="p">(</span>lpsa <span class="o">~</span> lcavol<span class="p">,</span> prostate<span class="p">)</span>
abline<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
g <span class="o">&lt;-</span> lm<span class="p">(</span>lpsa <span class="o">~</span> lcavol<span class="p">,</span> prostate<span class="p">)</span>
abline<span class="p">(</span>coef<span class="p">(</span>g<span class="p">),</span> lty<span class="o">=</span><span class="m">5</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_83_0.png"></p>
<p>The dotted regression line seems to fit very well.</p>
<h4>lcp ~ lspa</h4>
<div class="highlight"><pre><span></span><span class="kp">options</span><span class="p">(</span>repr.plot.width<span class="o">=</span><span class="m">4</span><span class="p">,</span> repr.plot.height<span class="o">=</span><span class="m">4</span><span class="p">)</span>
plot<span class="p">(</span>lpsa <span class="o">~</span> lcp<span class="p">,</span> prostate<span class="p">)</span>
abline<span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
g <span class="o">&lt;-</span> lm<span class="p">(</span>lpsa <span class="o">~</span> lcp<span class="p">,</span> prostate<span class="p">)</span>
abline<span class="p">(</span>coef<span class="p">(</span>g<span class="p">),</span> lty<span class="o">=</span><span class="m">5</span><span class="p">)</span>
</pre></div>


<p><img alt="png" src="images/output_86_0.png"></p>
<p>Even though the dotted line seems to be fitted very well, but inaccurate predictions could be made if the value of <em>lcp</em> is $-1.38629$</p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <hr />
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="/scraping-laliga-statistics-201819.html" rel="bookmark"
                           title="Permalink to Scraping LaLiga Statistics 2018/19">Scraping LaLiga Statistics 2018/19</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-08-19T00:00:00-04:00">
                Published: Mon 19 August 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info -->                <p><img alt="image" src="images/laliga.png"></p>
<p>If there's anythin I do besides data science, then it's definitely watching soccer--especially LaLiga. You might hear me scream for a goal if you pass by my house on a weekend. Lately I realized that just watching LaLiga wasn't enough for me, I wanted to explore how each and every </p>
                <a class="readmore" href="/scraping-laliga-statistics-201819.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/data-preprocessing.html" rel="bookmark"
                           title="Permalink to Data Preprocessing">Data Preprocessing</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-11-14T00:00:00-05:00">
                Published: Wed 14 November 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info -->                <p><img alt="image" src="images/ml.png"></p>
<p>It was 6 pm on October 17th, 2018, when the wind came crashing at my window. I woke up from my little nap and as usual  I picked up my phone and went to YouTube. Well thanks to YouTube for recommending me this Siraj Ravals video, where he simply </p>
                <a class="readmore" href="/data-preprocessing.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="/anscombes-quartet.html" rel="bookmark"
                           title="Permalink to Anscombe's Quartet">Anscombe's Quartet</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2018-09-19T00:00:00-04:00">
                Published: Wed 19 September 2018
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/parth-shah.html">Parth Shah</a>
        </address>
<p>In <a href="/category/blog.html">Blog</a>.</p>

</footer><!-- /.post-info -->                <p>I always believed in numerical calculations are exact, but graphs are rough. Coming from a person who has just started learning Data Analytics, it was hard for me to understand the importance of Data Visualization along with summary statistics. But it all changed after attending this Data Visualization Meetup, which </p>
                <a class="readmore" href="/anscombes-quartet.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
                </ol><!-- /#posts-list -->
                </section><!-- /#content -->
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="http://python.org/">Python.org</a></li>
                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>
                            <li><a href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate">atom feed</a></li>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="#">Another social link</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>